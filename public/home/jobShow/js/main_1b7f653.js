function file_check(obj,action_url,id,e){if(2==uploadFlag)return!1;uploadFlag=2,$("#loadingImg").css("visibility","visible");var obj=$("#"+id),userId=$("#userid").val();if(this.AllowExt=".doc,.docx,.pdf,.ppt,.pptx,.txt,.wps",this.FileExt=obj.val().substr(obj.val().lastIndexOf(".")).toLowerCase(),0!=this.AllowExt&&-1==this.AllowExt.indexOf(this.FileExt))"reUploadResume1"==id?$("#setResume span.error").show():"reUploadResume2"==id?$("#setResumeApply span.error").show():(errorTips("只支持word、pdf、ppt、txt、wps格式文件，请重新上传"),$("#loadingImg").css("visibility","hidden")),uploadFlag=1;else{if(""==this.FileExt)return!1;$.ajaxFileUpload({type:"POST",url:action_url,secureuri:!1,fileElementId:id,data:{userId:userId},dataType:"text",success:function(jsonStr){$("#setResumeApply span.error").hide(),$("#resumeSetForm span.error").hide();var json=eval("("+jsonStr+")");if($("#loadingImg").css("visibility","hidden"),json.success){var nearbyName="";nearbyName=json.content.nearbyName.length>18?json.content.nearbyName.substring(0,15)+"...":json.content.nearbyName,$(".resume0").prop("checked")?$("#resumeSendForm .btn_profile_save").removeAttr("disabled").css("backgroundColor","#019875"):$("#resumeSendForm .btn_profile_save").attr("disabled","disabled").css("backgroundColor","#a3a3a3"),"reUploadResume1"==id?($("#setResume .uploadedResume").text(nearbyName).attr("title",json.content.nearbyName).removeClass("red"),$("#setResume .downloadResume").removeClass("dn").siblings("span").removeClass("dn"),$("#setResume .reUpload").text("重新上传")):"reUploadResume2"==id?($("#setResumeApply .uploadedResume").text(nearbyName).attr("title",json.content.nearbyName).removeClass("red"),$("#setResumeApply .downloadResume").removeClass("dn").siblings("span").removeClass("dn"),$("#setResumeApply .reUpload").text("重新上传"),$("#setResumeApply .reUpload").next("#reUploadResume2").css("left","38px")):$.colorbox({inline:!0,href:$("div#uploadFileSuccess"),title:"上传附件简历"})}else-1==json.code?$.colorbox({inline:!0,href:$("div#fileResumeUpload"),title:"附件简历上传失败"}):-2==json.code?$.colorbox({inline:!0,href:$("div#fileResumeUploadSize"),title:"附件简历上传失败"}):(errorTips("简历上传失败，请重新上传"),$("#loadingImg").css("visibility","hidden"));uploadFlag=1},error:function(){errorTips("简历上传失败，请重新上传"),$("#loadingImg").css("visibility","hidden"),uploadFlag=1,$(".btn_s").click(function(){window.location.reload()}),$("#colorbox").on("click","#cboxClose",function(){"uploadFile"==$(this).siblings("#cboxLoadedContent").children("div").attr("id")&&window.location.reload()})}})}}define("mycenter-sidenav/modules/collections/main",["require","exports","module","common/widgets/mycenter-recommend/main","common/widgets/plat/poster","common/widgets/plat/exposure"],function(require){function a(a,c){$.colorbox({html:'<div id="uploadFile" class="popup"><table width="100%"><tr><td align="center"><h4 class="error_msg">'+a+'</h4></td></tr><tr><td align="center"><a href="javascript:;" class="btn_s">确&nbsp;定</a></td></tr></table></div>',title:c?c:"错误提示"})}function c(a){$.ajax({url:ctx+"/resume/queryConfirmInfo.json",data:{type:a},dataType:"json"}).done(function(a){if(a.success){$('#basicInfoForm input[name="name"]').val(a.content.name),a.content.highestEducation&&($('#basicInfoForm input[name="degree"]').val(a.content.highestEducation),$("#basicInfoForm #select_degree").val(a.content.highestEducation).css("color","#333")),a.content.workYear&&($('#basicInfoForm input[name="workyear"]').val(a.content.workYear),$("#basicInfoForm #select_workyear").val(a.content.workYear).css("color","#333")),a.content.city&&($('#basicInfoForm input[name="expectCity"]').val(a.content.city),$("#basicInfoForm #select_expectCity").val(a.content.city).css("color","#333")),$('#basicInfoForm input[name="tel"]').val(a.content.phone),$('#basicInfoForm input[name="email"]').val(a.content.email),$('#basicInfoForm input[name="type"]').val(a.content.type);for(var c="<ul>",i=0;i<a.content.workTimes.length;i++)c+="<li>"+a.content.workTimes[i]+"</li>";c+="</ul>",$("#basicInfoForm #box_workyear").html(c);for(var b="",i=0;i<a.content.citys.length;i++){b+="<dl><dt>"+a.content.citys[i].nameStr+"</dt><dd>";for(var h=0;h<a.content.citys[i].cityList.length;h++)b+="<span>"+a.content.citys[i].cityList[h]+"</span>";b+="</dd></dl>"}$("#basicInfoForm #box_expectCity").html(b);for(var v="<ul>",i=0;i<a.content.degrees.length;i++)v+="<li>"+a.content.degrees[i]+"</li>";v+="</ul>",$("#basicInfoForm #box_degree").html(v),$("#basicInfoForm").find("span.error").hide(),$.colorbox({inline:!0,href:$("#infoBeforeDeliverResume"),title:"个人信息确认"})}else alert(a.msg)})}function b(a){var c=a.parents("li").attr("data-id"),b=0,h=$("#resubmitToken").val();b=a.hasClass("collected")?0:1,$.ajax({url:ctx+"/mycenter/collectPositoin.json",type:"POST",async:!1,data:{positionId:c,type:b,resubmitToken:h},dataType:"json"}).done(function(c){null!=c.resubmitToken&&""!=c.resubmitToken&&$("#resubmitToken").val(c.resubmitToken),c.success?1==c.content.showStts?(a.removeClass("collected").html("收藏<span>已取消收藏</span>"),a.children("span").fadeIn(200).delay(500).fadeOut(200)):(a.addClass("collected").html("取消收藏<span>已成功收藏该职位</span>"),a.children("span").fadeIn(200).delay(500).fadeOut(200)):alert(c.msg),$(".collectionCancel").on("click")})}function h(){$.ajax({url:ctx+"/mycenter/showQRCode",type:"GET"}).done(function(a){a.success&&($(".saoma .drop_l img").attr("src",a.content),$("#deliverResumesSuccess .weixinQR .qr img").attr("src",a.content),$("#deliverResumesSuccess .weixinQR").removeClass("dn"))})}function v(){var a=$("#jobid").val(),c=window.location.href,re=/(http(s)?\:\/\/)?(www\.)?(\w+\:\d+)?(\/\w+)+\.(html)/gi,b=c.match(re),h=ctx+b+"?source=weixin",v=ctx+"/share/qrcode_share.png?code="+a+"&qrSource=weixin&flag=jobs&urlEncode="+encodeURIComponent(h);$("<img class='weixin_img'/>").appendTo(".jd_share_success"),$(".weixin_img").attr("src",v),$(".weixin_img").css({width:"131",height:"131"})}function g(t,a,c){var b=a.find("li"),h=a.children("dl"),v=[],g=[];if(b.length&&!(b.length<1)){if(b.each(function(){var a=$(this).attr(c);void 0!=a&&v.push(a)}),h.each(function(){var a=$(this).attr(c);g.push(a)}),""==v)var y=g.join(",");else var y=v.join(",");var _=y,C={t:t,dl:k,jids:_,z:R};w(C)}}function y(a){for(var c=[],$={},i=0;i<a.length;i++){var b=a[i],h=typeof b+b;1!==$[h]&&(c.push(b),$[h]=1)}return c}function _(a){for(var i=0,l=N.length;l>i;i++){var c=$(N[i]).data("id");if(2==a[c]){var b=$(N[i]).find(".co_item h2");b.append(T.clone())}}}require("common/widgets/mycenter-recommend/main"),require("common/widgets/plat/poster"),$("body").on("click",".btn_s",function(){$.colorbox.close()}),$(document).ajaxStart(function(){$(".collectionCancel").off("click")}),$("#collectionsForm").on("click","li .collectionCancel",function(e){if(e.preventDefault(),e.target==this){var a=$(this);b(a)}}),$(".AllButton").on("click",function(){$.get(ctx+"/subjectDeliver/isCanOneKeyDeliver.json",function(b){1==b.state?($(".allNum").html(b.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumeConfirm"),title:"一键投递确认"})):7==b.state?$.colorbox({inline:!0,href:$("#setResumeApply"),title:"投个简历"}):22==b.state?c(0):23==b.state?c(1):3==b.state?($(".allNum").html(b.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot"),title:"投递到达上限"})):4==b.state||5==b.state?$.colorbox({inline:!0,href:$("#deliverResumesNull"),title:"一键投递失败"}):6==b.state?($(".allNum").html(b.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot1"),title:"投递即将超过上限"})):a(999==b.state?"当前使用该功能的小伙伴过多，请稍后再试":b.message)},"json")}),$("#delayConfirmDeliver").on("click",function(){$.get(ctx+"/subjectDeliver/oneKeyDeliver.json",function(b){1==b.state?$.colorbox({inline:!0,href:$("#deliverResumesSuccess"),title:"一键投递"}):7==b.state?$.colorbox({inline:!0,href:$("#setResumeApply"),title:"投个简历"}):22==b.state?c(0):23==b.state?c(1):3==b.state?($(".allNum").html(b.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot"),title:"投递到达上限"})):4==b.state||5==b.state?$.colorbox({inline:!0,href:$("#deliverResumesNull"),title:"一键投递失败"}):6==b.state?($(".allNum").html(b.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot1"),title:"投递即将超过上限"})):a(999==b.state?"当前使用该功能的小伙伴过多，请稍后再试":b.message)},"json")}),$("#select_degree").bind("click",function(e){e.stopPropagation(),$("#select_workyear").removeClass("select_focus"),$("#select_expectCity").removeClass("select_focus"),$("#box_workyear").hide(),$("#box_expectCity").hide(),$(this).addClass("select_focus"),$("#box_degree").show()}),$("#box_degree").on("click","ul li",function(e){e.stopPropagation();var a=$(this).text();$("#select_degree").val(a).css("color","#333").removeClass("select_focus"),$("#degree").val(a),$("#box_degree").hide(),$(this).parents("#basicInfoForm").validate().element($("#degree"))}),$("#select_workyear").bind("click",function(e){e.stopPropagation(),$("#select_degree").removeClass("select_focus"),$("#select_expectCity").removeClass("select_focus"),$("#box_degree").hide(),$("#box_expectCity").hide(),$(this).addClass("select_focus"),$("#box_workyear").show()}),$("#box_workyear").on("click","ul li",function(e){e.stopPropagation();var a=$(this).text();$("#select_workyear").val(a).css("color","#333").removeClass("select_focus"),$("#workyear").val(a),$("#box_workyear").hide(),$(this).parents("#basicInfoForm").validate().element($("#workyear"))}),$("#select_expectCity").bind("click",function(e){e.stopPropagation(),$("#select_workyear").removeClass("select_focus"),$("#select_degree").removeClass("select_focus"),$("#box_workyear").hide(),$("#box_degree").hide(),$(this).addClass("select_focus"),$("#box_expectCity").show()}),$("#box_expectCity").on("click","dl dd span",function(e){e.stopPropagation();var a=$(this).text();$("#select_expectCity").val(a).css("color","#333").removeClass("select_focus"),$("#expectCity").val(a),$("#box_expectCity").hide(),$(this).parents("#basicInfoForm").validate().element($("#expectCity"))}),$("#resumeSendForm label.radio").bind("click",function(){$(this).children("span").hasClass("red")?$("#resumeSendForm .btn_profile_save").attr("disabled","disabled").css("backgroundColor","#a3a3a3"):$("#resumeSendForm .btn_profile_save").removeAttr("disabled").css("backgroundColor","#019875")}),$("#basicInfoForm").validate({rules:{name:{required:!0,truename:!0,rangeLenStr:[1,20]},degree:{required:!0},workyear:{required:!0},expectCity:{required:!0},tel:{required:!0,isMobile:!0,maxlength:30},email:{required:!0,email:!0,maxlength:100}},messages:{name:{required:"请输入你的真实姓名",truename:"请输入你的真实姓名",rangeLenStr:"请输入你的真实姓名"},degree:{required:"请选择最高学历"},workyear:{required:"请选择工作年限"},expectCity:{required:"请选择期望工作城市"},tel:{required:"请输入手机号码",isMobile:"请输入有效的手机号码",maxlength:"请输入有效的手机号码"},email:{required:"请输入接收面试通知邮箱",email:"请输入有效的常用邮箱",maxlength:"输入100字符以内的邮箱地址"}},errorPlacement:function(a,c){"hidden"==c.attr("type")?a.appendTo($(c).parent()):a.insertAfter(c)},submitHandler:function(b){var h=$('input[name="name"]',b).val(),v=$('input[name="degree"]',b).val(),g=$('input[name="workyear"]',b).val(),y=$('input[name="expectCity"]',b).val(),_=$('input[name="tel"]',b).val(),C=$.trim($('input[name="email"]',b).val()),w=$("#resubmitToken").val();$(b).find(":submit").attr("disabled",!0);var k=$('input[name="type"]',b).val();$.ajax({url:ctx+"/resume/saveConfirmAndDeliver.json",type:"POST",data:{name:h,highestEducation:v,workYear:g,city:y,phone:_,email:C,type:k,deliver:!0,resubmitToken:w},dataType:"json"}).done(function(r){null!=r.resubmitToken&&""!=r.resubmitToken&&$("#resubmitToken").val(r.resubmitToken),console.log(r),r.success?$.colorbox({inline:!0,href:$("#deliverResumesSuccess"),title:"一键投递"}):7==r.code?$.colorbox({inline:!0,href:$("#setResumeApply"),title:"投个简历"}):22==r.code?c(0):23==r.code?c(1):3==r.code?($(".allNum").html(r.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot"),title:"投递到达上限"})):4==r.code||5==r.code?$.colorbox({inline:!0,href:$("#deliverResumesNull"),title:"一键投递失败"}):6==r.code?($(".allNum").html(r.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot1"),title:"投递即将超过上限"})):a(999==r.code?"当前使用该功能的小伙伴过多，请稍后再试":r.msg),$(b).find(":submit").attr("disabled",!1)})}}),$("#resumeSendForm").validate({rules:{resumeName:{required:!0}},messages:{resumeName:{required:"请选择默认投递的简历"}},errorPlacement:function(a,c){a.insertBefore($(c).parent().siblings(".bgPink"))},submitHandler:function(b){{var h=$('input[name="resumeName"]:checked',b).val();$("#resubmitToken").val()}$(b).find(":submit").attr("disabled",!0);var v=-1;$('input[type="checkbox"]',b).prop("checked")&&(v=1),$.ajax({url:ctx+"/mycenterDelay/deliverResumeBeforce.json",type:"POST",data:{type:h,remember:v},dataType:"json"}).done(function(r){null!=r.resubmitToken&&""!=r.resubmitToken&&$("#resubmitToken").val(r.resubmitToken),console.log(r),r.success?($.colorbox.remove(),$.colorbox({inline:!0,href:$("#deliverResumesSuccess"),title:"一键投递"})):7==r.code?$.colorbox({inline:!0,href:$("#setResumeApply"),title:"投个简历"}):22==r.code?c(0):23==r.code?c(1):3==r.code?($(".allNum").html(r.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot"),title:"投递到达上限"})):4==r.code||5==r.code?$.colorbox({inline:!0,href:$("#deliverResumesNull"),title:"一键投递失败"}):6==r.code?($(".allNum").html(r.content.data.num),$.colorbox({inline:!0,href:$("#deliverResumesCanNot1"),title:"投递即将超过上限"})):a(999==r.code?"当前使用该功能的小伙伴过多，请稍后再试":r.msg),$(b).find(":submit").attr("disabled",!1)})}});var C=$("#similar_current").find(".guess_like_list_item").find("a");C.hover(function(){var a=$(this);a.next(".company_info").removeClass("dn")},function(){var a=$(this);a.next(".company_info").addClass("dn")}),$("#colorbox").on("click","#cboxClose",function(){("deliverResumesSuccess"==$(this).siblings("#cboxLoadedContent").children("div").attr("id")||"uploadFileSuccess"==$(this).siblings("#cboxLoadedContent").children("div").attr("id"))&&top.location.reload()}),v(),global.showQRCode&&h(),$(".Pagination").pager({currPage:global.currPage,pageNOName:"pageNo",form:"collectionsForm",pageCount:global.pageCount,pageSize:5});var w=require("common/widgets/plat/exposure").postoA,k=encodeURIComponent(document.URL),R=Math.random(),j=$(".my_collections"),F="data-id",t="collection";g(t,j,F);for(var I=[],N=$(".my_collections li"),i=0;i<N.length;i++)I.push($(N[i]).data("id"));I=y(I);I=I.join(",");var T=$("<i class='fl pos_icon1'></i>");jQuery.ajax({url:"http://www.lagou.com/activityapi/icon/showIcon.json",dataType:"jsonp",jsonp:"callback",data:{type:"POSITION",ids:I}}).done(function(a){_&&_(a)}),$(".fileResumeUploadSize, .fileResumeUpload").click(function(){$.colorbox({inline:!0,href:$("div#uploadFile"),title:"上传附件简历"})})});var uploadFlag=1;